actor:
  - name: 人事担当者
    description: スタッフの入退社管理、権限設定、アカウント管理を担当する責任者。スタッフ情報の正確な管理とセキュリティの確保が主な責務。

external_system:
  - name: メール配信サービス
    description: パスワードリセット通知やアカウント作成通知をスタッフに送信する外部サービス

aggregate:
  - スタッフ
  - 権限ロール
  - アカウント

feature:
  - name: スタッフ情報の登録・更新・削除
    description: 人事担当者がスタッフの入退社に伴う情報を管理できる。新規スタッフの登録、既存スタッフの情報変更、退職者の削除を行い、常に最新のスタッフ情報を維持する。
    events:
      - スタッフが登録された
      - スタッフ情報が更新された
      - スタッフが削除された
    policy:
      - name: 初期アカウント作成ポリシー
        trigger: スタッフが登録された
        action: 新規スタッフ用のログインアカウントを自動作成し、初期パスワードを発行する
      - name: アカウント無効化ポリシー
        trigger: スタッフが削除された
        action: 該当スタッフのログインアカウントを無効化し、システムへのアクセスを遮断する
    scenarios:
      - name: 新規スタッフ入社時の登録フロー
        precondition: 人事担当者がログイン済み、新規スタッフの入社が決定している
        steps:
          - スタッフ登録画面を開く
          - 新規スタッフの名前、メールアドレス、電話番号を入力する
          - 担当業務に応じた権限ロールを選択する
          - 入力内容を確認し、登録を確定する
          - システムが自動的に初期パスワードを発行し、スタッフにメール通知する
        postcondition: スタッフが登録され、ログインアカウントが作成される
      - name: スタッフ情報の変更フロー
        precondition: 人事担当者がログイン済み、変更対象のスタッフが存在する
        steps:
          - スタッフ一覧から対象スタッフを検索・選択する
          - スタッフ更新画面で変更が必要な項目を編集する
          - 変更内容を確認し、更新を確定する
        postcondition: スタッフ情報が更新される
      - name: 退職スタッフの削除フロー
        precondition: 人事担当者がログイン済み、スタッフの退職が確定している
        steps:
          - スタッフ一覧から退職予定のスタッフを検索・選択する
          - スタッフ削除画面で削除理由を確認する
          - 削除の最終確認を行い、削除を実行する
          - システムが該当アカウントを自動的に無効化する
        postcondition: スタッフ情報が削除され、アカウントが無効化される

  - name: パスワードリセット
    description: 人事担当者がスタッフのパスワードを再設定できる。パスワードを忘れたスタッフへの対応や、セキュリティ上の理由による強制リセットを行う。
    events:
      - パスワードがリセットされた
    policy:
      - name: パスワードリセット通知ポリシー
        trigger: パスワードがリセットされた
        action: 新しい仮パスワードをスタッフのメールアドレスに送信する
    scenarios:
      - name: パスワード忘れ対応フロー
        precondition: 人事担当者がログイン済み、スタッフからパスワードリセットの依頼がある
        steps:
          - パスワードリセット画面を開く
          - 対象スタッフを検索・選択する
          - 本人確認を行い、リセット理由を記録する
          - パスワードリセットを実行する
          - 新しい仮パスワードがスタッフにメール送信される
          - スタッフに初回ログイン時のパスワード変更を案内する
        postcondition: パスワードがリセットされ、スタッフが新しい仮パスワードでログイン可能になる

  - name: 権限ロールの割り当て・変更
    description: 人事担当者がスタッフの役割に応じた権限ロールを設定・変更できる。Admin、Reservation Manager、Front Desk、Housekeeping、Accounting、Owner View Onlyの6種類から適切なロールを選択し、業務に必要な機能へのアクセスを制御する。
    events:
      - 権限ロールが割り当てられた
      - 権限ロールが変更された
    policy:
      - name: 権限変更監査ポリシー
        trigger: 権限ロールが変更された
        action: 権限変更の履歴を監査ログに記録する
    scenarios:
      - name: 新規スタッフへの権限割り当てフロー
        precondition: 人事担当者がログイン済み、スタッフが登録済みで権限未設定
        steps:
          - 権限割り当て画面を開く
          - 対象スタッフを検索・選択する
          - スタッフの担当業務を確認する
          - 適切な権限ロールを選択する（Admin、Reservation Manager、Front Desk、Housekeeping、Accounting、Owner View Only）
          - 割り当て内容を確認し、確定する
        postcondition: スタッフに権限ロールが割り当てられ、対応する機能が利用可能になる
      - name: 異動に伴う権限変更フロー
        precondition: 人事担当者がログイン済み、スタッフの担当業務が変更される
        steps:
          - 権限変更画面を開く
          - 対象スタッフを検索・選択する
          - 現在の権限ロールと新しい担当業務を確認する
          - 新しい権限ロールを選択する
          - 変更内容を確認し、変更を実行する
          - 権限変更が監査ログに記録される
        postcondition: スタッフの権限ロールが更新され、新しい業務に対応した機能が利用可能になる

  - name: 権限設定の確認
    description: 人事担当者がスタッフの権限設定状況を検索・確認できる。各スタッフがどの権限ロールを持っているかを把握し、適切な権限管理を行う。
    events:
      - 権限情報が参照された
    policy: []
    scenarios:
      - name: スタッフ権限の棚卸しフロー
        precondition: 人事担当者がログイン済み
        steps:
          - 権限検索画面を開く
          - 権限ロールや部署などの条件で検索する
          - 検索結果からスタッフの権限設定一覧を確認する
          - 不適切な権限設定がないかチェックする
          - 必要に応じて権限変更画面へ遷移する
        postcondition: スタッフの権限設定状況が確認され、必要な是正措置が特定される
