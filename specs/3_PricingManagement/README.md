# 料金管理

## 背景

宿泊料金は季節やイベント、OTAごとに異なる料金設定が必要となる。シーズン別の料金体系とOTA別のレートプランを柔軟に管理することで、収益最大化と競争力の維持を実現する必要がある。

## 目的

- シーズンごとの料金変動を管理し、繁閑に応じた価格設定を実現する
- OTA別のレートプランを管理し、各販売チャネルに最適な料金を設定する
- サイトコントローラーとの連携により、料金・在庫情報を自動同期する

## 主要アクター

- 施設管理者
- 予約管理担当者

## 業務概要

料金管理では、シーズンとレートプランの登録・更新・削除・参照を行う。シーズンには期間、料金倍率、シーズン区分が設定され、予約日に基づいて自動適用される。レートプランは部屋タイプ・シーズン・OTA種別ごとに料金が設定され、サイトコントローラーに同期される。

## 要求

### 施設管理者
施設情報・部屋タイプ・部屋情報の登録・更新、プライシング・レート設定を行う

## 機能

### プライシングを管理する
- シーズンを登録する
  - シーズンを登録する（画面：シーズン登録画面、アクター：施設管理者）
  - 料金設定の基準となる期間を登録する
- シーズンを更新する
  - シーズンを更新する（画面：シーズン更新画面、アクター：施設管理者）
  - 既存シーズンの期間や料金を変更する
- シーズンを削除する
  - シーズンを削除する（画面：シーズン削除画面、アクター：施設管理者）
  - 不要なシーズンを削除する
- シーズンを参照する
  - シーズンを検索する（画面：シーズン検索画面、アクター：施設管理者、予約管理担当者）
  - 条件に基づいてシーズンを検索する

### レートプランを管理する
- レートプランを登録する
  - レートプランを登録する（画面：レートプラン登録画面、アクター：施設管理者）
  - OTA別・プラン別の料金体系を登録する
- レートプランを更新する
  - レートプランを更新する（画面：レートプラン更新画面、アクター：施設管理者）
  - 既存レートプランの料金を変更する
- レートプランを削除する
  - レートプランを削除する（画面：レートプラン削除画面、アクター：施設管理者）
  - 不要なレートプランを削除する
- レートプランを同期する
  - レートプランを同期する（イベント：レートプランを同期イベント、外部システム：サイトコントローラー）
  - サイトコントローラーにレートプランを送信する

## ビジネスルール

### シーズン料金自動適用
- コンテキスト：料金管理
- 説明：予約日がシーズン期間内の場合、自動的にシーズン料金を適用する
- 関連バリエーション：シーズン区分（通常期, 繁忙期, 閑散期, 特別期間）
- 適用ルール：全てのシーズン区分に対して自動適用

## ビジネスパラメーター

### シーズン区分
- 値：通常期、繁忙期、閑散期、特別期間
- 説明：料金変動の基準となる期間区分を表し、動的価格設定に使用する

### OTA種別
- 値：楽天トラベル、じゃらん、Booking.com、Airbnb、直接予約
- 説明：予約の流入元を表し、手数料率の適用やOTA別売上分析に使用する

### レートプラン同期方式
- 値：料金主導型、在庫主導型
- 説明：サイトコントローラーとの同期方法を表し、料金・在庫の更新ロジックに使用する

### サイトコントローラー種別
- 値：ねっぱん、Beds24、TL-Lincoln
- 説明：使用する外部連携システムを表し、API連携方式の切り替えに使用する
