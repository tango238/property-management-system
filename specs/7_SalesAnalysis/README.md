# 売上分析

## 背景

宿泊施設の経営判断には、売上データの正確な集計と分析が不可欠である。ADR（平均客室単価）、OCC（客室稼働率）、RevPAR（客室あたり収益）などの指標を算出し、OTA別や宿泊者属性別の売上を分析することで、収益最大化の戦略立案を支援する必要がある。

## 目的

- 予約データから売上金額を集計し、経営判断の基礎データを提供する
- ADR、OCC、RevPARなどの分析指標を自動算出する
- 過去データとの比較により、売上推移を把握する
- OTA別・宿泊者属性別の売上分析により、マーケティング戦略を支援する
- 監査対応のため、売上データを7年間保存する

## 主要アクター

- 経理担当者

## 業務概要

売上分析では、売上レポートの作成と売上推移の分析を行う。集計期間を設定し、予約データから売上金額を集計する。OTA種別に応じた手数料を自動計算し、純売上を算出する。ADR、OCC、RevPARなどの分析指標を計算し、レポート形式で出力する。過去の同時期との比較、OTA別売上分析、宿泊者属性別分析により、多角的な経営分析を実現する。

## 要求

### 経理担当者
売上レポートの作成、ADR・OCC・RevPARなどの分析指標の確認、監査対応を行う

## 機能

### 売上レポートを作成する
- 集計期間を指定する
  - 集計期間を設定する（画面：集計期間設定画面、アクター：経理担当者）
  - レポート作成の対象期間を設定する
- 売上データを集計する
  - 売上を集計する（画面：売上集計画面、アクター：経理担当者）
  - 予約データから売上金額を集計する
- 分析指標を算出する
  - 分析指標を算出する（画面：分析指標算出画面、アクター：経理担当者）
  - ADR、OCC、RevPARなどを計算する
- レポートを出力する
  - 売上レポートを出力する（画面：売上レポート出力画面、アクター：経理担当者）
  - 集計結果をレポート形式で出力する

### 売上推移を分析する
- 過去データと比較する
  - 前年同月比を算出する（画面：前年同月比算出画面、アクター：経理担当者）
  - 過去の同時期と売上を比較する
- OTA別に分析する
  - OTA別売上を分析する（画面：OTA別売上分析画面、アクター：経理担当者）
  - 流入元OTA別の売上を分析する
- 宿泊者属性を分析する
  - 宿泊者属性を分析する（画面：宿泊者属性分析画面、アクター：経理担当者）
  - 宿泊者の属性別に売上を分析する

## ビジネスルール

### 売上データ保存期間7年
- コンテキスト：売上分析
- 説明：監査対応のため、売上データを7年間保存する

### OTA手数料自動計算
- コンテキスト：売上分析
- 説明：OTA経由の予約は、OTA種別に応じた手数料率を自動適用する
- 関連バリエーション：OTA種別（楽天トラベル, じゃらん, Booking.com, Airbnb, 直接予約）
- 適用ルール：全てのOTA種別に対して自動適用

## ビジネスパラメーター

### OTA種別
- 値：楽天トラベル、じゃらん、Booking.com、Airbnb、直接予約
- 説明：予約の流入元を表し、手数料率の適用やOTA別売上分析に使用する
- 手数料率：
  - 楽天トラベル：自動適用
  - じゃらん：自動適用
  - Booking.com：自動適用
  - Airbnb：自動適用
  - 直接予約：自動適用

### 売上分析指標
- 値：ADR、OCC、RevPAR
- 説明：売上分析で使用する指標を表し、経営判断の基礎データとして活用する
- 指標の定義：
  - ADR（Average Daily Rate）：平均客室単価 = 総売上 ÷ 販売客室数
  - OCC（Occupancy Rate）：客室稼働率 = 販売客室数 ÷ 総客室数
  - RevPAR（Revenue Per Available Room）：客室あたり収益 = 総売上 ÷ 総客室数
