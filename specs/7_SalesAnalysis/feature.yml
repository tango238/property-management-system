actor:
  - name: 経理担当者
    description: 売上レポートの作成、ADR・OCC・RevPARなどの分析指標の確認、監査対応を担当する。予約データから売上を集計し、経営判断に必要な基礎データを提供することが主な役割。

external_system:
  - name: 予約管理システム
    description: 予約データ（宿泊日、料金、OTA種別、宿泊者情報など）を提供する連携元システム。売上集計の基礎データとなる予約情報を取得する。

aggregate:
  - 売上レポート
  - 売上集計
  - 分析指標
  - OTA手数料

feature:
  - name: 売上レポートの作成・出力
    description: 経理担当者が集計期間を指定し、予約データから売上金額を集計してレポート形式で出力する。OTA手数料を自動計算し純売上を算出することで、正確な売上把握を実現する。
    events:
      - 集計期間が設定された
      - 売上データが集計された
      - OTA手数料が計算された
      - 売上レポートが出力された
    policy:
      - name: OTA手数料自動計算ポリシー
        trigger: 売上データが集計された
        action: OTA種別に応じた手数料率を自動適用し、純売上を算出する
      - name: 売上データ保存ポリシー
        trigger: 売上レポートが出力された
        action: 売上データを7年間保存する
    scenarios:
      - name: 月次売上レポート作成フロー
        precondition: 経理担当者がログイン済み、予約データが確定済み
        steps:
          - 売上集計画面を開き、集計期間（月初〜月末）を設定する
          - 予約データから売上金額を自動集計する
          - OTA種別ごとの手数料を自動計算し、純売上を算出する
          - ADR、OCC、RevPARの分析指標を算出する
          - 集計結果を確認し、売上レポートをPDF/Excel形式で出力する
          - 経営会議用の資料として保存する
        postcondition: 売上レポートが出力され、売上データが保存される
      - name: 監査対応用データ抽出フロー
        precondition: 監査担当者から売上データの提出依頼がある
        steps:
          - 指定された期間（過去7年以内）の売上データを検索する
          - 該当期間の売上レポートを一覧表示する
          - 必要なレポートを選択し、エクスポートする
          - 監査担当者に提出する
        postcondition: 監査対応用の売上データが抽出・提出される

  - name: 分析指標（ADR・OCC・RevPAR）の算出・表示
    description: 予約データと客室情報から ADR（平均客室単価）、OCC（客室稼働率）、RevPAR（客室あたり収益）を自動計算し、経営判断の基礎データを提供する。
    events:
      - ADRが算出された
      - OCCが算出された
      - RevPARが算出された
      - 分析指標が表示された
    policy:
      - name: 分析指標自動更新ポリシー
        trigger: 売上データが集計された
        action: ADR、OCC、RevPARを自動的に再計算して最新化する
    scenarios:
      - name: 日次稼働率確認フロー
        precondition: 当日の予約・チェックインデータが登録済み
        steps:
          - 分析指標画面を開く
          - 本日の稼働率（OCC）をダッシュボードで確認する
          - 過去7日間の推移グラフで傾向を把握する
          - 目標値との乖離を確認し、必要に応じてアラートを設定する
        postcondition: 当日の稼働状況が把握できる
      - name: 月次KPI分析フロー
        precondition: 月次売上データが集計済み
        steps:
          - 分析指標画面で対象月を選択する
          - ADR、OCC、RevPARの値を確認する
          - 前月・前年同月との比較表を表示する
          - 目標達成率を確認し、改善ポイントを特定する
          - 分析結果を経営会議資料に反映する
        postcondition: 月次KPIの分析が完了し、改善ポイントが特定される

  - name: 売上推移の前年同月比較
    description: 過去の同時期（前年同月、前々年同月など）と売上を比較し、売上推移の傾向を把握する。成長率や季節変動を分析し、マーケティング戦略の立案を支援する。
    events:
      - 前年同月比が算出された
      - 売上推移グラフが生成された
      - 比較レポートが出力された
    policy:
      - name: 前年同月比自動算出ポリシー
        trigger: 売上データが集計された
        action: 前年同月のデータを自動取得し、比較値を算出する
    scenarios:
      - name: 年間売上トレンド分析フロー
        precondition: 過去2年以上の売上データが蓄積されている
        steps:
          - 売上推移分析画面を開く
          - 比較対象期間（過去24ヶ月）を設定する
          - 月別売上推移グラフを表示する
          - 前年同月比の増減率を確認する
          - 季節変動パターンを特定し、繁忙期・閑散期を把握する
          - 来年度の売上予測に活用する
        postcondition: 年間の売上トレンドが把握でき、来年度計画の基礎データとなる
      - name: 売上減少要因分析フロー
        precondition: 前年同月比で売上が減少している月がある
        steps:
          - 売上減少月を特定する
          - 前年同月との詳細比較を行う
          - 客室稼働率と平均単価の変動を分析する
          - 外部要因（競合出店、イベント中止など）を確認する
          - 改善施策を立案する
        postcondition: 売上減少の要因が特定され、改善施策が立案される

  - name: OTA別売上分析
    description: 楽天トラベル、じゃらん、Booking.com、Airbnb、直接予約などの流入元OTA別に売上を分析する。OTAごとの売上構成比、手数料負担、純利益率を把握し、販売チャネル戦略の最適化を支援する。
    events:
      - OTA別売上が集計された
      - OTA別構成比が算出された
      - OTA別手数料が集計された
    policy:
      - name: OTA別集計自動実行ポリシー
        trigger: 売上データが集計された
        action: OTA種別ごとに売上・手数料・純利益を自動集計する
    scenarios:
      - name: OTA別収益性分析フロー
        precondition: 月次売上データが集計済み、OTA手数料率が設定済み
        steps:
          - OTA別売上分析画面を開く
          - 対象期間を設定する
          - OTA別の売上金額・予約件数を一覧表示する
          - 各OTAの手数料額と純利益を確認する
          - 収益性の高いOTAと低いOTAを比較する
          - 販売チャネルのポートフォリオ見直しを検討する
        postcondition: OTA別の収益性が把握でき、チャネル戦略の見直し材料が得られる
      - name: 直接予約比率向上施策検討フロー
        precondition: OTA経由の予約比率が高く、手数料負担が大きい
        steps:
          - OTA別売上構成比を確認する
          - 直接予約の比率と推移を分析する
          - 手数料負担額を算出する
          - 直接予約促進施策（会員特典、公式サイト割引など）を検討する
          - 施策実施後の効果測定指標を設定する
        postcondition: 直接予約比率向上のための施策が立案される

  - name: 宿泊者属性別売上分析
    description: 宿泊者の属性（国籍、年齢層、利用目的など）別に売上を分析する。ターゲット顧客層の特定、高単価セグメントの発見、マーケティング戦略の立案を支援する。
    events:
      - 宿泊者属性別売上が集計された
      - 属性別構成比が算出された
      - 顧客セグメント分析が完了した
    policy:
      - name: 属性別集計自動実行ポリシー
        trigger: 売上データが集計された
        action: 宿泊者属性ごとに売上・平均単価・滞在日数を自動集計する
    scenarios:
      - name: インバウンド売上分析フロー
        precondition: 国籍情報を含む予約データが蓄積されている
        steps:
          - 宿泊者属性分析画面を開く
          - 国籍別の売上一覧を表示する
          - インバウンド比率と国別構成比を確認する
          - 国別の平均単価と滞在日数を比較する
          - ターゲット国の選定とプロモーション戦略を検討する
        postcondition: インバウンド売上の構造が把握でき、ターゲット国が特定される
      - name: 利用目的別単価分析フロー
        precondition: 利用目的（ビジネス、観光、帰省など）が予約データに含まれている
        steps:
          - 利用目的別の売上・予約件数を集計する
          - 目的別の平均単価を比較する
          - 高単価セグメント（記念日利用、長期滞在など）を特定する
          - 高単価セグメント向けのプラン開発を検討する
          - 販促施策の優先順位を決定する
        postcondition: 利用目的別の収益性が把握でき、高単価セグメント向け施策が立案される
